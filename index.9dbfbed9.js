function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||r(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,r){if(t){if("string"==typeof t)return e(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,r)}}var n=document.querySelector(".button"),i=document.querySelectorAll(".message"),o=document.querySelector("tbody"),s=document.querySelector(".field-row");function a(e,t){return Math.floor(Math.random()*(t-e+1))+e}function l(e){return e.filter(function(e){return 0!==e})}function c(e){return e.map(function(e){return t(e)})}new(function(){var e;function o(e,t){var r=e.x,n=e.y;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,o),this.size={x:r,y:n},this.controlBtns=t,this.grid=Array(this.size.y);for(var i=0;i<this.grid.length;i++)this.grid[i]=Array(this.size.x).fill(0);this.handleKeyPress=this.handleKeyPress.bind(this),this.handlers=[],this.score=0}return e=[{key:"addRandomCell",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=0;t<e;t++){var r=this.grid.map(function(e,t){return e.includes(0)?t:void 0}).filter(function(e){return void 0!==e});if(0===r.length)return;var n=r[a(0,r.length-1)],i=this.grid[n].map(function(e,t){return e?void 0:t}).filter(function(e){return void 0!==e});if(0===i.length)return;var o=i[a(0,i.length-1)];10===a(1,10)?this.grid[n][o]+=4:this.grid[n][o]+=2}}},{key:"removeCell",value:function(e,t){var r=this;"number"!=typeof e||"number"!=typeof t?this.grid=Array(this.size.y).fill(0).map(function(){return Array(r.size.x).fill(0)}):this.grid[t][e]=0,this.render()}},{key:"render",value:function(){var e=this;this.grid.forEach(function(t,r){var n=document.querySelector("tbody .field-row:nth-child(".concat(r+1,")"));e.grid[r].forEach(function(t,r){var i=n.querySelector(".field-cell:nth-child(".concat(r+1,")"));i.classList.value="field-cell field-cell--".concat(t),t?i.textContent=t:i.textContent="",e.checkWin(t),e.checkLose()})})}},{key:"renderScore",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.score+=e,document.querySelector(".game-score").textContent=this.score}},{key:"combineAdjacentDuplicates",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=l(e),n=0,i=0;i<r.length-1;i++){var o=r[i],s=r[i+1];o===s&&(r[i]+=s,r[i+1]=0,n+=r[i])}return t&&this.renderScore(n),l(r)}},{key:"checkWin",value:function(e){e>=2048&&(document.querySelector(".message-win").classList.remove("hidden"),this.removeAllEventListeners())}},{key:"checkLose",value:function(){var e=this,t=function(t){var r=[];e.grid.forEach(function(e){r.push(e[t])}),JSON.stringify(e.combineAdjacentDuplicates(r)).length===JSON.stringify(r).length&&(i-=1)},r=this,n=document.querySelector(".message-lose"),i=this.size.x+this.size.y;this.grid.forEach(function(e){JSON.stringify(r.combineAdjacentDuplicates(e)).length===JSON.stringify(e).length&&(i-=1)});for(var o=0;o<this.size.x;o++)t(o);i<=0&&(this.removeAllEventListeners(),n.classList.remove("hidden"))}},{key:"removeAllEventListeners",value:function(){var e=!0,t=!1,r=void 0;try{for(var n,i=this.handlers[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){var o=n.value,s=o.eventHandler,a=o.handler;document.removeEventListener(s,a)}}catch(e){t=!0,r=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw r}}this.handlers=[]}},{key:"setupRestartButton",value:function(e){var t=this;e.addEventListener("click",function(){t.restartGame()})}},{key:"setupControlButtons",value:function(e){var t=this,r=!0,n=!1,i=void 0;try{for(var o,s=this,a=e[Symbol.iterator]();!(r=(o=a.next()).done);r=!0)!function(){var e=o.value,r=function(r){return t.handleKeyPress(r,e)};document.addEventListener("keydown",r),s.handlers.push({eventHandler:"keydown",handler:r})}()}catch(e){n=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}}},{key:"handleKeyPress",value:function(e,t){var n=function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r,n,i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var o=[],s=!0,a=!1;try{for(i=i.call(e);!(s=(r=i.next()).done)&&(o.push(r.value),4!==o.length);s=!0);}catch(e){a=!0,n=e}finally{try{s||null==i.return||i.return()}finally{if(a)throw n}}return o}}(t,4)||r(t,4)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=n[0],o=n[1],s=n[2],a=n[3];switch(e.key){case i:this.moveLeft();break;case o:this.moveUp();break;case s:this.moveRight();break;case a:this.moveDown()}}},{key:"moveLeft",value:function(){var e=this,r=c(this.grid);this.grid.forEach(function(r,n){var i,o=e.combineAdjacentDuplicates(r,!0);(i=e.grid[n]).unshift.apply(i,t(o)),e.grid[n].length=e.size.x,e.grid[n].fill(0,o.length)}),JSON.stringify(r)!==JSON.stringify(this.grid)&&this.addRandomCell(1),this.render()}},{key:"moveUp",value:function(){for(var e=this,t=function(t){var n=[];e.grid.forEach(function(e){n.push(e[t])});var i=e.combineAdjacentDuplicates(n,!0);if(i.length!==e.size.y){var o=i.length;i.length=e.size.y,i.fill(0,o)}e.grid.forEach(function(e,n){r.grid[n][t]=i[n]})},r=this,n=c(this.grid),i=0;i<this.size.x;i++)t(i);JSON.stringify(n)!==JSON.stringify(this.grid)&&this.addRandomCell(1),this.render()}},{key:"moveRight",value:function(){var e=this,r=c(this.grid);this.grid.forEach(function(r,n){var i,o=e.combineAdjacentDuplicates(r.slice().reverse(),!0);(i=e.grid[n]).unshift.apply(i,t(o)),e.grid[n].length=e.size.x,e.grid[n].fill(0,o.length),JSON.stringify(r)!==JSON.stringify(o.reverse())&&e.grid[n].reverse()}),JSON.stringify(r)!==JSON.stringify(this.grid)&&this.addRandomCell(1),this.render()}},{key:"moveDown",value:function(){for(var e=this,r=function(r){var i=[];e.grid.forEach(function(e){i.push(e[r])});var o=e.combineAdjacentDuplicates(i.slice().reverse(),!0).reverse();if(o.length!==e.size.y){var s=e.size.y-o.length;o.unshift.apply(o,t(Array(s).fill(0))),e.grid.forEach(function(e,t){n.grid[t][r]=o[t]})}},n=this,i=c(this.grid),o=0;o<this.size.x;o++)r(o);JSON.stringify(i)!==JSON.stringify(this.grid)&&this.addRandomCell(1),this.render()}},{key:"restartGame",value:function(){n.textContent="Restart",n.classList.remove("start"),n.classList.add("restart"),i.forEach(function(e){e.classList.contains("hidden")||e.classList.add("hidden")}),this.removeCell(),this.addRandomCell(2),this.render(),this.removeAllEventListeners(),this.setupControlButtons(this.controlBtns),this.score=0,this.renderScore()}},{key:"gridState",value:function(){window.console.log(this.grid)}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(o.prototype,e),o}())({x:s.childElementCount,y:o.childElementCount},[["a","w","d","s"],["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"]]).setupRestartButton(n);
//# sourceMappingURL=index.9dbfbed9.js.map
